# FastChat ä¸€é”®æŠ¥å‘Šç”Ÿæˆè„šæœ¬ä½¿ç”¨æŒ‡å—

## æ¦‚è¿°

`generate_report.py` æ˜¯ä¸€ä¸ªè‡ªåŠ¨åŒ–è„šæœ¬ï¼Œå¯ä»¥ä¸€é”®åˆ†æž FastChat Arena æŠ•ç¥¨æ•°æ®å¹¶ç”Ÿæˆç¾Žè§‚çš„æŠ¥å‘Šï¼Œæ”¯æŒå®šæ—¶ä»»åŠ¡æ‰§è¡Œã€‚

## åŠŸèƒ½ç‰¹æ€§

- ðŸš€ **ä¸€é”®ç”Ÿæˆ**: è‡ªåŠ¨æŸ¥æ‰¾æœ€æ–°æ—¥å¿—æ–‡ä»¶å¹¶åˆ†æž
- ðŸ“Š **å¤šæ ¼å¼æŠ¥å‘Š**: ç”ŸæˆHTMLå¯è§†åŒ–æŠ¥å‘Šå’ŒMarkdownæ‘˜è¦
- ðŸŽ¨ **ç¾Žè§‚ç•Œé¢**: çŽ°ä»£åŒ–çš„å“åº”å¼è®¾è®¡ï¼Œæ”¯æŒå›¾è¡¨å’Œè¡¨æ ¼
- ðŸ§¹ **è‡ªåŠ¨æ¸…ç†**: å¯é…ç½®çš„æ—§æŠ¥å‘Šæ¸…ç†åŠŸèƒ½
- â° **å®šæ—¶ä»»åŠ¡**: æ”¯æŒcrontabç­‰å®šæ—¶ä»»åŠ¡ç³»ç»Ÿ
- ðŸ“ **çµæ´»é…ç½®**: æ”¯æŒè‡ªå®šä¹‰è¾“å‡ºç›®å½•å’Œæ–‡ä»¶æ¨¡å¼

## å¿«é€Ÿå¼€å§‹

### 1. åŸºæœ¬ä½¿ç”¨

```bash
# ä½¿ç”¨é»˜è®¤è®¾ç½®ï¼ˆè‡ªåŠ¨æŸ¥æ‰¾æœ€æ–°æ—¥å¿—æ–‡ä»¶ï¼‰
python generate_report.py

# æŒ‡å®šæ—¥å¿—æ–‡ä»¶
python generate_report.py --log-file 2025-06-26-conv.json

# æŒ‡å®šæ—¥å¿—ç›®å½•
python generate_report.py --log-dir /path/to/logs
```

### 2. è‡ªå®šä¹‰è¾“å‡º

```bash
# æŒ‡å®šè¾“å‡ºç›®å½•
python generate_report.py --output-dir /path/to/reports

# åªç”ŸæˆHTMLæŠ¥å‘Š
python generate_report.py --html-only

# åªç”Ÿæˆæ‘˜è¦æŠ¥å‘Š
python generate_report.py --summary-only
```

### 3. æ¸…ç†è®¾ç½®

```bash
# æ¸…ç†7å¤©å‰çš„æ—§æŠ¥å‘Šï¼ˆé»˜è®¤ï¼‰
python generate_report.py --cleanup-days 7

# ä¸æ¸…ç†æ—§æŠ¥å‘Š
python generate_report.py --no-cleanup

# æ¸…ç†30å¤©å‰çš„æ—§æŠ¥å‘Š
python generate_report.py --cleanup-days 30
```

## å‘½ä»¤è¡Œå‚æ•°

| å‚æ•° | ç±»åž‹ | é»˜è®¤å€¼ | è¯´æ˜Ž |
|------|------|--------|------|
| `--log-file` | str | None | æŒ‡å®šæ—¥å¿—æ–‡ä»¶è·¯å¾„ |
| `--log-dir` | str | "." | æ—¥å¿—æ–‡ä»¶ç›®å½• |
| `--pattern` | str | "*-conv.json" | æ—¥å¿—æ–‡ä»¶åŒ¹é…æ¨¡å¼ |
| `--output-dir` | str | "reports" | æŠ¥å‘Šè¾“å‡ºç›®å½• |
| `--cleanup-days` | int | 7 | æ¸…ç†Nå¤©å‰çš„æ—§æŠ¥å‘Š |
| `--no-cleanup` | flag | False | ä¸æ¸…ç†æ—§æŠ¥å‘Š |
| `--html-only` | flag | False | åªç”ŸæˆHTMLæŠ¥å‘Š |
| `--summary-only` | flag | False | åªç”Ÿæˆæ‘˜è¦æŠ¥å‘Š |

## è¾“å‡ºæ–‡ä»¶

è„šæœ¬ä¼šåœ¨æŒ‡å®šçš„è¾“å‡ºç›®å½•ä¸­ç”Ÿæˆä»¥ä¸‹æ–‡ä»¶ï¼š

### HTMLæŠ¥å‘Š
- `report_YYYYMMDD_HHMMSS.html` - å®Œæ•´çš„å¯è§†åŒ–æŠ¥å‘Š
- åŒ…å«å›¾è¡¨ã€è¡¨æ ¼ã€ç»Ÿè®¡ä¿¡æ¯
- å“åº”å¼è®¾è®¡ï¼Œæ”¯æŒç§»åŠ¨è®¾å¤‡

### æ‘˜è¦æŠ¥å‘Š
- `summary_YYYYMMDD_HHMMSS.md` - Markdownæ ¼å¼æ‘˜è¦
- åŒ…å«å…³é”®ç»Ÿè®¡æ•°æ®å’ŒæŽ’åä¿¡æ¯
- é€‚åˆé‚®ä»¶å‘é€æˆ–æ–‡æ¡£å­˜æ¡£

### æ•°æ®æ–‡ä»¶
- `vote_analysis.csv` - æŠ•ç¥¨ç»Ÿè®¡åˆ†æž
- `elo_rankings.csv` - ELOæŽ’åæ•°æ®
- `vote_distribution.json` - æŠ•ç¥¨åˆ†å¸ƒæ•°æ®

## å®šæ—¶ä»»åŠ¡é…ç½®

### 1. æ¯å°æ—¶è¿è¡Œ

```bash
# ç¼–è¾‘crontab
crontab -e

# æ·»åŠ ä»¥ä¸‹è¡Œï¼ˆæ¯å°æ—¶è¿è¡Œï¼‰
0 * * * * cd /path/to/FastChat && /path/to/python generate_report.py --output-dir /path/to/reports
```

### 2. æ¯å¤©è¿è¡Œ

```bash
# æ¯å¤©å‡Œæ™¨2ç‚¹è¿è¡Œ
0 2 * * * cd /path/to/FastChat && /path/to/python generate_report.py --output-dir /path/to/reports
```

### 3. æ¯å‘¨è¿è¡Œ

```bash
# æ¯å‘¨æ—¥å‡Œæ™¨3ç‚¹è¿è¡Œ
0 3 * * 0 cd /path/to/FastChat && /path/to/python generate_report.py --output-dir /path/to/reports --cleanup-days 30
```

## ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹1: åŸºæœ¬åˆ†æž

```bash
# åˆ†æžæœ€æ–°æ—¥å¿—æ–‡ä»¶
python generate_report.py

# è¾“å‡ºç¤ºä¾‹:
# ðŸš€ FastChat ä¸€é”®æŠ¥å‘Šç”Ÿæˆè„šæœ¬
# ==================================================
# ðŸ“„ ä½¿ç”¨æ—¥å¿—æ–‡ä»¶: 2025-06-26-conv.json
# ðŸ”„ æŠ•ç¥¨ç»Ÿè®¡åˆ†æž...
# âœ… æŠ•ç¥¨ç»Ÿè®¡åˆ†æž å®Œæˆ
# ðŸ”„ ELOæŽ’ååˆ†æž...
# âœ… ELOæŽ’ååˆ†æž å®Œæˆ
# ðŸŒ åˆ›å»ºæŠ¥å‘ŠHTMLé¡µé¢...
# âœ… æŠ¥å‘Šå·²ç”Ÿæˆ: report_20250626_143022.html
# ðŸ“‹ åˆ›å»ºæ‘˜è¦æŠ¥å‘Š...
# âœ… æ‘˜è¦æŠ¥å‘Šå·²ç”Ÿæˆ: summary_20250626_143022.md
# ðŸ§¹ æ¸…ç†7å¤©å‰çš„æ—§æŠ¥å‘Š...
# ==================================================
# âœ… æŠ¥å‘Šç”Ÿæˆå®Œæˆï¼
# ðŸ“ è¾“å‡ºç›®å½•: /path/to/reports
# ðŸ“Š ç”Ÿæˆçš„æ–‡ä»¶:
#   - report_20250626_143022.html
#   - summary_20250626_143022.md
```

### ç¤ºä¾‹2: è‡ªå®šä¹‰é…ç½®

```bash
# æŒ‡å®šæ—¥å¿—æ–‡ä»¶å’Œè¾“å‡ºç›®å½•
python generate_report.py \
  --log-file /path/to/logs/2025-06-26-conv.json \
  --output-dir /var/www/reports \
  --cleanup-days 14 \
  --html-only

# è¾“å‡ºç¤ºä¾‹:
# ðŸš€ FastChat ä¸€é”®æŠ¥å‘Šç”Ÿæˆè„šæœ¬
# ==================================================
# ðŸ“„ ä½¿ç”¨æ—¥å¿—æ–‡ä»¶: /path/to/logs/2025-06-26-conv.json
# ðŸ”„ æŠ•ç¥¨ç»Ÿè®¡åˆ†æž...
# âœ… æŠ•ç¥¨ç»Ÿè®¡åˆ†æž å®Œæˆ
# ðŸ”„ ELOæŽ’ååˆ†æž...
# âœ… ELOæŽ’ååˆ†æž å®Œæˆ
# ðŸŒ åˆ›å»ºæŠ¥å‘ŠHTMLé¡µé¢...
# âœ… æŠ¥å‘Šå·²ç”Ÿæˆ: report_20250626_143022.html
# ðŸ§¹ æ¸…ç†14å¤©å‰çš„æ—§æŠ¥å‘Š...
# ==================================================
# âœ… æŠ¥å‘Šç”Ÿæˆå®Œæˆï¼
# ðŸ“ è¾“å‡ºç›®å½•: /var/www/reports
# ðŸ“Š ç”Ÿæˆçš„æ–‡ä»¶:
#   - report_20250626_143022.html
```

## æŠ¥å‘Šå†…å®¹

### HTMLæŠ¥å‘ŠåŒ…å«

1. **ç»Ÿè®¡æ¦‚è§ˆ**
   - æ€»æŠ•ç¥¨æ•°
   - å‚ä¸Žæ¨¡åž‹æ•°
   - æœ‰æ•ˆå¯¹æˆ˜æ•°
   - åˆ†æžæ—¥æœŸ

2. **å¯è§†åŒ–å›¾è¡¨**
   - æŠ•ç¥¨ç±»åž‹åˆ†å¸ƒï¼ˆé¥¼å›¾ï¼‰
   - æ¨¡åž‹èƒœçŽ‡å¯¹æ¯”ï¼ˆæŸ±çŠ¶å›¾ï¼‰

3. **ELOæŽ’åè¡¨**
   - æŽ’åã€æ¨¡åž‹åç§°ã€ELOè¯„åˆ†
   - æ€»å¯¹æˆ˜ã€èƒœåˆ©ã€å¤±è´¥ã€å¹³å±€ã€èƒœçŽ‡

4. **è¯¦ç»†ç»Ÿè®¡è¡¨**
   - å„æ¨¡åž‹çš„è¯¦ç»†ç»Ÿè®¡æ•°æ®
   - èƒœçŽ‡ã€å¹³å±€çŽ‡ã€å¤±è´¥çŽ‡

### æ‘˜è¦æŠ¥å‘ŠåŒ…å«

1. **æŠ¥å‘Šä¿¡æ¯**
   - ç”Ÿæˆæ—¶é—´ã€åˆ†æžå·¥å…·ã€æ•°æ®æ¥æº

2. **ç»Ÿè®¡æ¦‚è§ˆ**
   - å…³é”®ç»Ÿè®¡æ•°æ®

3. **æŠ•ç¥¨åˆ†å¸ƒ**
   - å·¦æ–¹èŽ·èƒœã€å³æ–¹èŽ·èƒœã€å¹³å±€æ¬¡æ•°

4. **ELOæŽ’åç»“æžœ**
   - æ¯ä¸ªæ¨¡åž‹çš„è¯¦ç»†æŽ’åä¿¡æ¯

5. **è¯¦ç»†ç»Ÿè®¡è¡¨æ ¼**
   - Markdownæ ¼å¼çš„ç»Ÿè®¡è¡¨æ ¼

## æ•…éšœæŽ’é™¤

### å¸¸è§é—®é¢˜

1. **æ‰¾ä¸åˆ°æ—¥å¿—æ–‡ä»¶**
   ```bash
   # æ£€æŸ¥æ—¥å¿—æ–‡ä»¶æ˜¯å¦å­˜åœ¨
   ls -la *.json
   
   # æŒ‡å®šæ­£ç¡®çš„æ—¥å¿—æ–‡ä»¶
   python generate_report.py --log-file your-log-file.json
   ```

2. **æƒé™é—®é¢˜**
   ```bash
   # ç¡®ä¿è„šæœ¬æœ‰æ‰§è¡Œæƒé™
   chmod +x generate_report.py
   
   # ç¡®ä¿è¾“å‡ºç›®å½•å¯å†™
   mkdir -p reports && chmod 755 reports
   ```

3. **ä¾èµ–é—®é¢˜**
   ```bash
   # ç¡®ä¿å®‰è£…äº†å¿…è¦çš„ä¾èµ–
   pip install pandas numpy matplotlib
   ```

### æ—¥å¿—æ–‡ä»¶æ ¼å¼

è„šæœ¬æœŸæœ›çš„æ—¥å¿—æ–‡ä»¶æ ¼å¼ï¼š
```json
[
  {
    "tstamp": "2025-06-26 14:30:22",
    "type": "vote",
    "models": ["model1", "model2"],
    "winner": "model1",
    "anony": false,
    "ip": "127.0.0.1"
  }
]
```

## é«˜çº§é…ç½®

### çŽ¯å¢ƒå˜é‡

å¯ä»¥è®¾ç½®ä»¥ä¸‹çŽ¯å¢ƒå˜é‡æ¥è‡ªå®šä¹‰è¡Œä¸ºï¼š

```bash
# è®¾ç½®é»˜è®¤è¾“å‡ºç›®å½•
export FASTCHAT_REPORT_DIR="/var/www/reports"

# è®¾ç½®æ—¥å¿—ç›®å½•
export FASTCHAT_LOG_DIR="/var/log/fastchat"

# è®¾ç½®æ¸…ç†å¤©æ•°
export FASTCHAT_CLEANUP_DAYS=7
```

### é…ç½®æ–‡ä»¶

å¯ä»¥åˆ›å»ºé…ç½®æ–‡ä»¶æ¥è‡ªå®šä¹‰è®¾ç½®ï¼š

```bash
# åˆ›å»ºé…ç½®æ–‡ä»¶
cat > report_config.json << EOF
{
  "default_output_dir": "/var/www/reports",
  "default_log_dir": "/var/log/fastchat",
  "cleanup_days": 7,
  "log_pattern": "*-conv.json"
}
EOF
```

## æ€§èƒ½ä¼˜åŒ–

### å¤§æ–‡ä»¶å¤„ç†

å¯¹äºŽå¤§åž‹æ—¥å¿—æ–‡ä»¶ï¼Œå¯ä»¥è€ƒè™‘ï¼š

1. **åˆ†æ‰¹å¤„ç†**
   ```bash
   # æŒ‰æ—¥æœŸåˆ†å‰²æ—¥å¿—æ–‡ä»¶
   python generate_report.py --log-file 2025-06-26-conv.json
   ```

2. **å¢žé‡åˆ†æž**
   ```bash
   # åªåˆ†æžæ–°å¢žçš„æŠ•ç¥¨æ•°æ®
   python generate_report.py --pattern "*-conv-*.json"
   ```

### å†…å­˜ä¼˜åŒ–

å¯¹äºŽå†…å­˜å—é™çš„çŽ¯å¢ƒï¼š

```bash
# åªç”Ÿæˆæ‘˜è¦æŠ¥å‘Šï¼ˆå†…å­˜å ç”¨æ›´å°‘ï¼‰
python generate_report.py --summary-only

# æ¸…ç†æ—§æŠ¥å‘Šé‡Šæ”¾ç©ºé—´
python generate_report.py --cleanup-days 1
```

## é›†æˆå»ºè®®

### WebæœåŠ¡å™¨é›†æˆ

```bash
# å°†æŠ¥å‘Šç›®å½•é…ç½®ä¸ºWebæœåŠ¡å™¨æ ¹ç›®å½•
sudo ln -s /path/to/reports /var/www/html/fastchat-reports

# è®¿é—®æŠ¥å‘Š
# http://your-server/fastchat-reports/
```

### é‚®ä»¶é€šçŸ¥

```bash
# åˆ›å»ºé‚®ä»¶é€šçŸ¥è„šæœ¬
cat > notify_report.sh << 'EOF'
#!/bin/bash
REPORT_DIR="/path/to/reports"
LATEST_REPORT=$(ls -t $REPORT_DIR/report_*.html | head -1)

if [ -n "$LATEST_REPORT" ]; then
    echo "FastChatæŠ¥å‘Šå·²ç”Ÿæˆ: $LATEST_REPORT" | mail -s "FastChatæŠ¥å‘Šæ›´æ–°" your-email@example.com
fi
EOF

# åœ¨crontabä¸­æ·»åŠ é‚®ä»¶é€šçŸ¥
0 2 * * * /path/to/notify_report.sh
```

### ç›‘æŽ§é›†æˆ

```bash
# æ£€æŸ¥æŠ¥å‘Šç”ŸæˆçŠ¶æ€
python generate_report.py --output-dir /path/to/reports
if [ $? -eq 0 ]; then
    echo "æŠ¥å‘Šç”ŸæˆæˆåŠŸ"
else
    echo "æŠ¥å‘Šç”Ÿæˆå¤±è´¥"
    # å‘é€å‘Šè­¦
fi
```

## æ€»ç»“

`generate_report.py` è„šæœ¬æä¾›äº†ä¸€ä¸ªå®Œæ•´çš„è§£å†³æ–¹æ¡ˆæ¥è‡ªåŠ¨åŒ– FastChat Arena æŠ•ç¥¨æ•°æ®çš„åˆ†æžå’ŒæŠ¥å‘Šç”Ÿæˆã€‚é€šè¿‡åˆç†é…ç½®å®šæ—¶ä»»åŠ¡ï¼Œå¯ä»¥å®žçŽ°æŒç»­çš„æ•°æ®ç›‘æŽ§å’ŒæŠ¥å‘Šæ›´æ–°ï¼Œä¸ºæ¨¡åž‹æ€§èƒ½è¯„ä¼°æä¾›åŠæ—¶ã€å‡†ç¡®çš„æ•°æ®æ”¯æŒã€‚ 